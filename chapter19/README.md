19 章 並列性
===

- Rust での並列処理におけるスレッドの使い方
  - フォーク・ジョイン並列
  - チャネル
  - 可変状態の共有



## フォーク・ジョイン並列

- 非常に単純。実装もシンプル
- ボトルネックがない。待ちが発生するのはフォークされたスレッドが最後にジョインされる部分のみ
- 独立したユニットに分割できる場合のみ使える
- `std::thread::spawn()`: 新しいスレッドを作成する
- main 関数は、中で走っているスレッドがあっても (何もしなければ) それらの終了を待たずに終了する
  - main を終了するまでにフォークしたすべてのスレッドを join する
- `handle.join()` は Result を返すので、適切にエラーハンドリングをすれば各スレッド内でのパニックはそのスレッド内にのみ影響する
  - `unwrap()` で暗黙的に処理したりすると親スレッドにパニックを伝搬することになる
- **不変の** 共通の値を複数のスレッドで共有するためには `Arc<T>` 型としてスレッドに渡す
- `spawn` もいいが、もうちょっといい感じにスレッド管理してくれる **Rayon** というクレートがある
  - [rayon - crates.io: Rust Package Registry](https://crates.io/crates/rayon)




## チャネル





## 可変状態の共有




